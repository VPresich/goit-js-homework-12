{"version":3,"file":"commonHelpers3.js","sources":["../src/js/task-8-1/modal-window-slider.js","../src/js/task-8-1/modal-window-handles.js"],"sourcesContent":["import SliderInterface from '../common/slider-interface.js';\n\nclass ModalWindowSlider extends SliderInterface {\n  #sliderContent;\n  #elementsList;\n\n  constructor(params) {\n    const { elementsList, sliderContent } = params;\n    super(params);\n\n    this.#elementsList = elementsList;\n    this.#sliderContent = sliderContent;\n\n    super.update();\n  }\n\n  destroy() {\n    super.destroy();\n  }\n\n  updateContent() {\n    const slideNumber = super.getCurrentSlide();\n    const imgRef = this.#elementsList[slideNumber].querySelector('img');\n    const aRef = this.#elementsList[slideNumber].querySelector('a');\n\n    if (imgRef.dataset.source) {\n      this.#sliderContent.src = imgRef.dataset.source;\n    } else {\n      if (aRef.href) {\n        this.#sliderContent.src = aRef.href;\n      } else {\n        this.#sliderContent.src = imgRef.src;\n      }\n    }\n\n    this.#sliderContent.alt = imgRef.alt;\n  }\n}\n\nexport default ModalWindowSlider;\n","import { KEY_CODE_ESC } from '../common/constants.js';\n\nimport ModalWindowSlider from './modal-window-slider.js';\nimport createCardsGallery from '../common/create-cards-gallery.js';\nimport getImages from '../common/get-images.js';\n\nimport { createErrMsg } from '../common/create-msg.js';\nimport { BGR_GALLERY, BGR_BODY } from '../common/constants.js';\n\nimport GalleryPagination from '../common/gallery-pagination.js';\n\nlet searchString = '';\nconst defaultElementsPerPage = 20;\n\nconst refs = {\n  gallery: document.querySelector('.gallery'),\n  modalBackdrop: document.querySelector('.modal-backdrop'),\n  buttonClose: document.querySelector('.close-button'),\n  modalContent: document.querySelector('.modal-content'),\n  modalClose: document.querySelector('#closeBtn'),\n  loader: document.querySelector('.border-loader'),\n  searchForm: document.querySelector('.search-form'),\n};\n\nrefs.gallery.addEventListener('click', onGalleryImageClick);\nrefs.buttonClose.addEventListener('click', onCloseModalWindow);\nrefs.modalBackdrop.addEventListener('click', onBackdropClick);\nrefs.modalClose.addEventListener('click', onCloseModalWindow);\nrefs.searchForm.addEventListener('submit', onSearchFormSubmit);\n\nconst galleryPagination = new GalleryPagination({\n  data: [],\n  fnCreateMarkup: createCardsGallery,\n  fnGetImages: getImages,\n  contentRef: refs.gallery,\n  elementsPerPage: defaultElementsPerPage,\n  searchStr: searchString,\n});\n\nlet modalWindowSlider;\nconst dataForSlider = {\n  slidesPerPage: 1,\n  prevBtnId: 'prevBtn',\n  nextBtnId: 'nextBtn',\n  dotsContainerId: 'sliderDots',\n  sliderContainerId: 'modalContent',\n  slidesCounterId: 'slidesCounter',\n  dotDefaultClass: 'slider-dot',\n  dotActiveClass: 'active-dot',\n  isDotContainText: false,\n  sliderContent: refs.modalContent,\n};\n\nfunction onGalleryImageClick(event) {\n  event.preventDefault();\n  const targetRef = event.target;\n\n  const isImageRef =\n    targetRef.classList.contains('card-cover') ||\n    targetRef.classList.contains('card-cover-darkened');\n\n  if (!isImageRef) {\n    return;\n  }\n\n  const closestLi = targetRef.closest('li');\n  const listImages = event.currentTarget.children;\n  const indexList = Array.from(listImages).indexOf(closestLi);\n\n  modalWindowSlider = new ModalWindowSlider({\n    ...dataForSlider,\n    currentSlide: indexList,\n    elementsList: listImages,\n    elementsListLength: listImages.length,\n  });\n\n  openModalWindow();\n}\n\nfunction onSearchFormSubmit(event) {\n  event.preventDefault();\n  searchString = event.currentTarget.search.value.trim();\n  refs.loader.style.display = 'block';\n\n  getImages(searchString, 1)\n    .then(images => {\n      refreshOnSuccess(images);\n    })\n    .catch(error => {\n      refreshOnError(error);\n    });\n}\n\nfunction openModalWindow() {\n  refs.modalBackdrop.classList.add('is-open');\n  window.addEventListener('keydown', onWindowKeydown);\n}\n\nfunction onCloseModalWindow(event) {\n  window.removeEventListener('keydown', onWindowKeydown);\n  refs.modalBackdrop.classList.remove('is-open');\n  modalWindowSlider.destroy();\n}\n\nfunction onWindowKeydown(event) {\n  if (event.code === KEY_CODE_ESC) {\n    onCloseModalWindow(event);\n  }\n}\n\nfunction onBackdropClick(event) {\n  if (event.currentTarget === event.target) {\n    onCloseModalWindow(event);\n  }\n}\n\nfunction refreshOnError(msg) {\n  refs.searchForm.search.value = '';\n  refs.loader.style.display = 'none';\n  // createErrMsg(msg);\n  console.log(msg);\n  refs.gallery.style.backgroundColor = BGR_BODY;\n  galleryPagination && galleryPagination.refresh();\n}\n\nfunction refreshOnSuccess(data) {\n  refs.searchForm.search.value = '';\n  refs.loader.style.display = 'none';\n  refs.gallery.style.backgroundColor = BGR_GALLERY;\n\n  galleryPagination && galleryPagination.refresh();\n\n  const maxPages = Math.ceil(data.totalHits / defaultElementsPerPage);\n  galleryPagination.addData(data.hits, maxPages, searchString);\n}\n"],"names":["ModalWindowSlider","SliderInterface","params","elementsList","sliderContent","__privateAdd","_sliderContent","_elementsList","__privateSet","slideNumber","imgRef","__privateGet","aRef","searchString","defaultElementsPerPage","refs","onGalleryImageClick","onCloseModalWindow","onBackdropClick","onSearchFormSubmit","galleryPagination","GalleryPagination","createCardsGallery","getImages","modalWindowSlider","dataForSlider","event","targetRef","closestLi","listImages","indexList","openModalWindow","images","refreshOnSuccess","error","refreshOnError","onWindowKeydown","KEY_CODE_ESC","msg","BGR_BODY","data","BGR_GALLERY","maxPages"],"mappings":"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"}